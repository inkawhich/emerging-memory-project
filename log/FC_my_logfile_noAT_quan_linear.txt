nbits:1
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.017989 train_acc: 0.078125
[0/10][100/469] train_loss: 0.017989 train_acc: 0.094910
[0/10][200/469] train_loss: 0.017989 train_acc: 0.096937
[0/10][300/469] train_loss: 0.017989 train_acc: 0.097825
[0/10][400/469] train_loss: 0.017989 train_acc: 0.098426
Clean dataset testing:[0/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[0/10] val_loss: 0.018190 val_acc: 0.098000
[1/10][0/469] train_loss: 0.017989 train_acc: 0.093750
[1/10][100/469] train_loss: 0.017989 train_acc: 0.101717
[1/10][200/469] train_loss: 0.017989 train_acc: 0.099619
[1/10][300/469] train_loss: 0.017989 train_acc: 0.098656
[1/10][400/469] train_loss: 0.017989 train_acc: 0.098893
Clean dataset testing:[1/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[1/10] val_loss: 0.018190 val_acc: 0.098000
[2/10][0/469] train_loss: 0.017989 train_acc: 0.140625
[2/10][100/469] train_loss: 0.017989 train_acc: 0.101485
[2/10][200/469] train_loss: 0.017989 train_acc: 0.100785
[2/10][300/469] train_loss: 0.017994 train_acc: 0.099149
[2/10][400/469] train_loss: 0.017999 train_acc: 0.098445
Clean dataset testing:[2/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[2/10] val_loss: 0.018190 val_acc: 0.098000
[3/10][0/469] train_loss: 0.017989 train_acc: 0.125000
[3/10][100/469] train_loss: 0.018027 train_acc: 0.098314
[3/10][200/469] train_loss: 0.018035 train_acc: 0.101990
[3/10][300/469] train_loss: 0.018041 train_acc: 0.099382
[3/10][400/469] train_loss: 0.018047 train_acc: 0.099244
Clean dataset testing:[3/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[3/10] val_loss: 0.018190 val_acc: 0.098000
[4/10][0/469] train_loss: 0.017989 train_acc: 0.148438
[4/10][100/469] train_loss: 0.018050 train_acc: 0.097618
[4/10][200/469] train_loss: 0.018041 train_acc: 0.098609
[4/10][300/469] train_loss: 0.018043 train_acc: 0.099045
[4/10][400/469] train_loss: 0.018042 train_acc: 0.099692
Clean dataset testing:[4/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[4/10] val_loss: 0.018190 val_acc: 0.098000
[5/10][0/469] train_loss: 0.017989 train_acc: 0.093750
[5/10][100/469] train_loss: 0.018035 train_acc: 0.101098
[5/10][200/469] train_loss: 0.018047 train_acc: 0.099852
[5/10][300/469] train_loss: 0.018047 train_acc: 0.099045
[5/10][400/469] train_loss: 0.018047 train_acc: 0.100140
Clean dataset testing:[5/10] val_loss: 0.018382 val_acc: 0.098000
AT dataset testing:[5/10] val_loss: 0.018382 val_acc: 0.098000
[6/10][0/469] train_loss: 0.018089 train_acc: 0.093750
[6/10][100/469] train_loss: 0.018050 train_acc: 0.098004
[6/10][200/469] train_loss: 0.018054 train_acc: 0.097637
[6/10][300/469] train_loss: 0.018062 train_acc: 0.098837
[6/10][400/469] train_loss: 0.018069 train_acc: 0.098504
Clean dataset testing:[6/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[6/10] val_loss: 0.018190 val_acc: 0.098000
[7/10][0/469] train_loss: 0.017989 train_acc: 0.117188
[7/10][100/469] train_loss: 0.018071 train_acc: 0.097076
[7/10][200/469] train_loss: 0.018060 train_acc: 0.099230
[7/10][300/469] train_loss: 0.018056 train_acc: 0.100420
[7/10][400/469] train_loss: 0.018058 train_acc: 0.100647
Clean dataset testing:[7/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[7/10] val_loss: 0.018190 val_acc: 0.098000
[8/10][0/469] train_loss: 0.017989 train_acc: 0.070312
[8/10][100/469] train_loss: 0.018064 train_acc: 0.101098
[8/10][200/469] train_loss: 0.018069 train_acc: 0.101873
[8/10][300/469] train_loss: 0.018062 train_acc: 0.101225
[8/10][400/469] train_loss: 0.018061 train_acc: 0.101660
Clean dataset testing:[8/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[8/10] val_loss: 0.018190 val_acc: 0.098000
[9/10][0/469] train_loss: 0.017989 train_acc: 0.109375
[9/10][100/469] train_loss: 0.018048 train_acc: 0.106126
[9/10][200/469] train_loss: 0.018062 train_acc: 0.105216
[9/10][300/469] train_loss: 0.018059 train_acc: 0.102886
[9/10][400/469] train_loss: 0.018060 train_acc: 0.101562
Clean dataset testing:[9/10] val_loss: 0.018382 val_acc: 0.098000
AT dataset testing:[9/10] val_loss: 0.018382 val_acc: 0.098000
nbits:2
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.017989 train_acc: 0.070312
[0/10][100/469] train_loss: 0.017989 train_acc: 0.096535
[0/10][200/469] train_loss: 0.017989 train_acc: 0.098609
[0/10][300/469] train_loss: 0.017989 train_acc: 0.098552
[0/10][400/469] train_loss: 0.017988 train_acc: 0.100121
Clean dataset testing:[0/10] val_loss: 0.018198 val_acc: 0.113500
AT dataset testing:[0/10] val_loss: 0.018198 val_acc: 0.113500
[1/10][0/469] train_loss: 0.018007 train_acc: 0.109375
[1/10][100/469] train_loss: 0.017997 train_acc: 0.103651
[1/10][200/469] train_loss: 0.018000 train_acc: 0.102029
[1/10][300/469] train_loss: 0.018001 train_acc: 0.102315
[1/10][400/469] train_loss: 0.017999 train_acc: 0.103725
Clean dataset testing:[1/10] val_loss: 0.018198 val_acc: 0.113500
AT dataset testing:[1/10] val_loss: 0.018198 val_acc: 0.113500
[2/10][0/469] train_loss: 0.017987 train_acc: 0.117188
[2/10][100/469] train_loss: 0.018001 train_acc: 0.100170
[2/10][200/469] train_loss: 0.017999 train_acc: 0.103001
[2/10][300/469] train_loss: 0.018000 train_acc: 0.102782
[2/10][400/469] train_loss: 0.018001 train_acc: 0.103881
Clean dataset testing:[2/10] val_loss: 0.018223 val_acc: 0.113500
AT dataset testing:[2/10] val_loss: 0.018223 val_acc: 0.113500
[3/10][0/469] train_loss: 0.018075 train_acc: 0.148438
[3/10][100/469] train_loss: 0.018010 train_acc: 0.102800
[3/10][200/469] train_loss: 0.018006 train_acc: 0.105605
[3/10][300/469] train_loss: 0.018006 train_acc: 0.106364
[3/10][400/469] train_loss: 0.018005 train_acc: 0.106803
Clean dataset testing:[3/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[3/10] val_loss: 0.018190 val_acc: 0.098000
[4/10][0/469] train_loss: 0.017989 train_acc: 0.140625
[4/10][100/469] train_loss: 0.018019 train_acc: 0.102181
[4/10][200/469] train_loss: 0.018018 train_acc: 0.102690
[4/10][300/469] train_loss: 0.018014 train_acc: 0.102471
[4/10][400/469] train_loss: 0.018013 train_acc: 0.102673
Clean dataset testing:[4/10] val_loss: 0.018199 val_acc: 0.098000
AT dataset testing:[4/10] val_loss: 0.018199 val_acc: 0.098000
[5/10][0/469] train_loss: 0.017886 train_acc: 0.085938
[5/10][100/469] train_loss: 0.018004 train_acc: 0.107828
[5/10][200/469] train_loss: 0.018007 train_acc: 0.104594
[5/10][300/469] train_loss: 0.018010 train_acc: 0.104314
[5/10][400/469] train_loss: 0.018010 train_acc: 0.103998
Clean dataset testing:[5/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[5/10] val_loss: 0.018190 val_acc: 0.098000
[6/10][0/469] train_loss: 0.017989 train_acc: 0.125000
[6/10][100/469] train_loss: 0.018017 train_acc: 0.103496
[6/10][200/469] train_loss: 0.018013 train_acc: 0.103428
[6/10][300/469] train_loss: 0.018012 train_acc: 0.103509
[6/10][400/469] train_loss: 0.018008 train_acc: 0.104933
Clean dataset testing:[6/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[6/10] val_loss: 0.018190 val_acc: 0.098000
[7/10][0/469] train_loss: 0.017989 train_acc: 0.101562
[7/10][100/469] train_loss: 0.018011 train_acc: 0.105275
[7/10][200/469] train_loss: 0.018003 train_acc: 0.104633
[7/10][300/469] train_loss: 0.018007 train_acc: 0.104444
[7/10][400/469] train_loss: 0.018008 train_acc: 0.105089
Clean dataset testing:[7/10] val_loss: 0.018198 val_acc: 0.113500
AT dataset testing:[7/10] val_loss: 0.018198 val_acc: 0.113500
[8/10][0/469] train_loss: 0.018048 train_acc: 0.093750
[8/10][100/469] train_loss: 0.018000 train_acc: 0.103419
[8/10][200/469] train_loss: 0.018000 train_acc: 0.103467
[8/10][300/469] train_loss: 0.018001 train_acc: 0.104340
[8/10][400/469] train_loss: 0.018003 train_acc: 0.103374
Clean dataset testing:[8/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[8/10] val_loss: 0.018190 val_acc: 0.098000
[9/10][0/469] train_loss: 0.017989 train_acc: 0.148438
[9/10][100/469] train_loss: 0.018003 train_acc: 0.105585
[9/10][200/469] train_loss: 0.018004 train_acc: 0.104672
[9/10][300/469] train_loss: 0.018004 train_acc: 0.104911
[9/10][400/469] train_loss: 0.018007 train_acc: 0.105829
Clean dataset testing:[9/10] val_loss: 0.018190 val_acc: 0.098000
AT dataset testing:[9/10] val_loss: 0.018190 val_acc: 0.098000
nbits:3
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.017989 train_acc: 0.156250
[0/10][100/469] train_loss: 0.017989 train_acc: 0.098933
[0/10][200/469] train_loss: 0.017989 train_acc: 0.098997
[0/10][300/469] train_loss: 0.017987 train_acc: 0.099953
[0/10][400/469] train_loss: 0.017986 train_acc: 0.103004
Clean dataset testing:[0/10] val_loss: 0.018179 val_acc: 0.113500
AT dataset testing:[0/10] val_loss: 0.018179 val_acc: 0.113500
[1/10][0/469] train_loss: 0.017961 train_acc: 0.140625
[1/10][100/469] train_loss: 0.017979 train_acc: 0.112160
[1/10][200/469] train_loss: 0.017983 train_acc: 0.111552
[1/10][300/469] train_loss: 0.017983 train_acc: 0.111088
[1/10][400/469] train_loss: 0.017982 train_acc: 0.111245
Clean dataset testing:[1/10] val_loss: 0.018184 val_acc: 0.113500
AT dataset testing:[1/10] val_loss: 0.018184 val_acc: 0.113500
[2/10][0/469] train_loss: 0.018054 train_acc: 0.085938
[2/10][100/469] train_loss: 0.017987 train_acc: 0.111463
[2/10][200/469] train_loss: 0.017985 train_acc: 0.112212
[2/10][300/469] train_loss: 0.017984 train_acc: 0.111763
[2/10][400/469] train_loss: 0.017985 train_acc: 0.110934
Clean dataset testing:[2/10] val_loss: 0.018186 val_acc: 0.113500
AT dataset testing:[2/10] val_loss: 0.018186 val_acc: 0.113500
[3/10][0/469] train_loss: 0.017981 train_acc: 0.125000
[3/10][100/469] train_loss: 0.017991 train_acc: 0.107209
[3/10][200/469] train_loss: 0.017988 train_acc: 0.107198
[3/10][300/469] train_loss: 0.017987 train_acc: 0.109193
[3/10][400/469] train_loss: 0.017987 train_acc: 0.108518
Clean dataset testing:[3/10] val_loss: 0.018186 val_acc: 0.113500
AT dataset testing:[3/10] val_loss: 0.018186 val_acc: 0.113500
[4/10][0/469] train_loss: 0.018016 train_acc: 0.109375
[4/10][100/469] train_loss: 0.017983 train_acc: 0.111696
[4/10][200/469] train_loss: 0.017984 train_acc: 0.112329
[4/10][300/469] train_loss: 0.017986 train_acc: 0.111996
[4/10][400/469] train_loss: 0.017985 train_acc: 0.112687
Clean dataset testing:[4/10] val_loss: 0.018185 val_acc: 0.113500
AT dataset testing:[4/10] val_loss: 0.018185 val_acc: 0.113500
[5/10][0/469] train_loss: 0.017979 train_acc: 0.101562
[5/10][100/469] train_loss: 0.017988 train_acc: 0.107054
[5/10][200/469] train_loss: 0.017984 train_acc: 0.110969
[5/10][300/469] train_loss: 0.017986 train_acc: 0.110180
[5/10][400/469] train_loss: 0.017984 train_acc: 0.112083
Clean dataset testing:[5/10] val_loss: 0.018188 val_acc: 0.113500
AT dataset testing:[5/10] val_loss: 0.018188 val_acc: 0.113500
[6/10][0/469] train_loss: 0.018009 train_acc: 0.093750
[6/10][100/469] train_loss: 0.017982 train_acc: 0.113552
[6/10][200/469] train_loss: 0.017984 train_acc: 0.112912
[6/10][300/469] train_loss: 0.017987 train_acc: 0.110387
[6/10][400/469] train_loss: 0.017988 train_acc: 0.109005
Clean dataset testing:[6/10] val_loss: 0.018183 val_acc: 0.113500
AT dataset testing:[6/10] val_loss: 0.018183 val_acc: 0.113500
[7/10][0/469] train_loss: 0.017995 train_acc: 0.101562
[7/10][100/469] train_loss: 0.017986 train_acc: 0.111928
[7/10][200/469] train_loss: 0.017984 train_acc: 0.111163
[7/10][300/469] train_loss: 0.017984 train_acc: 0.112671
[7/10][400/469] train_loss: 0.017983 train_acc: 0.112882
Clean dataset testing:[7/10] val_loss: 0.018179 val_acc: 0.113500
AT dataset testing:[7/10] val_loss: 0.018179 val_acc: 0.113500
[8/10][0/469] train_loss: 0.018022 train_acc: 0.117188
[8/10][100/469] train_loss: 0.017977 train_acc: 0.118038
[8/10][200/469] train_loss: 0.017986 train_acc: 0.112718
[8/10][300/469] train_loss: 0.017986 train_acc: 0.112074
[8/10][400/469] train_loss: 0.017985 train_acc: 0.112882
Clean dataset testing:[8/10] val_loss: 0.018198 val_acc: 0.103200
AT dataset testing:[8/10] val_loss: 0.018198 val_acc: 0.103200
[9/10][0/469] train_loss: 0.018033 train_acc: 0.070312
[9/10][100/469] train_loss: 0.017996 train_acc: 0.103264
[9/10][200/469] train_loss: 0.017989 train_acc: 0.107898
[9/10][300/469] train_loss: 0.017990 train_acc: 0.107973
[9/10][400/469] train_loss: 0.017991 train_acc: 0.107797
Clean dataset testing:[9/10] val_loss: 0.018184 val_acc: 0.113500
AT dataset testing:[9/10] val_loss: 0.018184 val_acc: 0.113500
nbits:4
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.017985 train_acc: 0.132812
[0/10][100/469] train_loss: 0.004248 train_acc: 0.840811
[0/10][200/469] train_loss: 0.003110 train_acc: 0.883823
[0/10][300/469] train_loss: 0.002605 train_acc: 0.901864
[0/10][400/469] train_loss: 0.002270 train_acc: 0.914160
Clean dataset testing:[0/10] val_loss: 0.000960 val_acc: 0.960800
AT dataset testing:[0/10] val_loss: 0.164580 val_acc: 0.000000
[1/10][0/469] train_loss: 0.001264 train_acc: 0.937500
[1/10][100/469] train_loss: 0.000850 train_acc: 0.965888
[1/10][200/469] train_loss: 0.000865 train_acc: 0.964708
[1/10][300/469] train_loss: 0.000843 train_acc: 0.966284
[1/10][400/469] train_loss: 0.000817 train_acc: 0.967639
Clean dataset testing:[1/10] val_loss: 0.000692 val_acc: 0.973400
AT dataset testing:[1/10] val_loss: 0.195737 val_acc: 0.000000
[2/10][0/469] train_loss: 0.000778 train_acc: 0.976562
[2/10][100/469] train_loss: 0.000567 train_acc: 0.977723
[2/10][200/469] train_loss: 0.000547 train_acc: 0.979283
[2/10][300/469] train_loss: 0.000541 train_acc: 0.979184
[2/10][400/469] train_loss: 0.000522 train_acc: 0.979660
Clean dataset testing:[2/10] val_loss: 0.000614 val_acc: 0.975800
AT dataset testing:[2/10] val_loss: 0.216413 val_acc: 0.000000
[3/10][0/469] train_loss: 0.000376 train_acc: 0.984375
[3/10][100/469] train_loss: 0.000373 train_acc: 0.985303
[3/10][200/469] train_loss: 0.000383 train_acc: 0.984608
[3/10][300/469] train_loss: 0.000389 train_acc: 0.984609
[3/10][400/469] train_loss: 0.000384 train_acc: 0.984414
Clean dataset testing:[3/10] val_loss: 0.000650 val_acc: 0.974600
AT dataset testing:[3/10] val_loss: 0.234106 val_acc: 0.000000
[4/10][0/469] train_loss: 0.000582 train_acc: 0.968750
[4/10][100/469] train_loss: 0.000267 train_acc: 0.989093
[4/10][200/469] train_loss: 0.000285 train_acc: 0.988456
[4/10][300/469] train_loss: 0.000284 train_acc: 0.988164
[4/10][400/469] train_loss: 0.000297 train_acc: 0.987843
Clean dataset testing:[4/10] val_loss: 0.000570 val_acc: 0.978800
AT dataset testing:[4/10] val_loss: 0.263892 val_acc: 0.000000
[5/10][0/469] train_loss: 0.000354 train_acc: 0.984375
[5/10][100/469] train_loss: 0.000183 train_acc: 0.992188
[5/10][200/469] train_loss: 0.000219 train_acc: 0.990788
[5/10][300/469] train_loss: 0.000220 train_acc: 0.990760
[5/10][400/469] train_loss: 0.000226 train_acc: 0.990356
Clean dataset testing:[5/10] val_loss: 0.000593 val_acc: 0.977000
AT dataset testing:[5/10] val_loss: 0.282396 val_acc: 0.000000
[6/10][0/469] train_loss: 0.000078 train_acc: 1.000000
[6/10][100/469] train_loss: 0.000172 train_acc: 0.992884
[6/10][200/469] train_loss: 0.000152 train_acc: 0.993742
[6/10][300/469] train_loss: 0.000184 train_acc: 0.992136
[6/10][400/469] train_loss: 0.000181 train_acc: 0.992324
Clean dataset testing:[6/10] val_loss: 0.000524 val_acc: 0.980600
AT dataset testing:[6/10] val_loss: 0.325731 val_acc: 0.000000
[7/10][0/469] train_loss: 0.000526 train_acc: 0.984375
[7/10][100/469] train_loss: 0.000124 train_acc: 0.995127
[7/10][200/469] train_loss: 0.000131 train_acc: 0.994675
[7/10][300/469] train_loss: 0.000148 train_acc: 0.993823
[7/10][400/469] train_loss: 0.000166 train_acc: 0.993123
Clean dataset testing:[7/10] val_loss: 0.000646 val_acc: 0.977600
AT dataset testing:[7/10] val_loss: 0.322133 val_acc: 0.000000
[8/10][0/469] train_loss: 0.000072 train_acc: 0.992188
[8/10][100/469] train_loss: 0.000111 train_acc: 0.995436
[8/10][200/469] train_loss: 0.000112 train_acc: 0.995375
[8/10][300/469] train_loss: 0.000116 train_acc: 0.995094
[8/10][400/469] train_loss: 0.000133 train_acc: 0.994233
Clean dataset testing:[8/10] val_loss: 0.000612 val_acc: 0.978100
AT dataset testing:[8/10] val_loss: 0.335014 val_acc: 0.000000
[9/10][0/469] train_loss: 0.000095 train_acc: 0.992188
[9/10][100/469] train_loss: 0.000109 train_acc: 0.995746
[9/10][200/469] train_loss: 0.000097 train_acc: 0.996035
[9/10][300/469] train_loss: 0.000099 train_acc: 0.995873
[9/10][400/469] train_loss: 0.000122 train_acc: 0.994857
Clean dataset testing:[9/10] val_loss: 0.000696 val_acc: 0.979600
AT dataset testing:[9/10] val_loss: 0.378067 val_acc: 0.000000
nbits:5
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.018018 train_acc: 0.085938
[0/10][100/469] train_loss: 0.004877 train_acc: 0.826114
[0/10][200/469] train_loss: 0.003397 train_acc: 0.877371
[0/10][300/469] train_loss: 0.002764 train_acc: 0.899917
[0/10][400/469] train_loss: 0.002363 train_acc: 0.913147
Clean dataset testing:[0/10] val_loss: 0.000925 val_acc: 0.962600
AT dataset testing:[0/10] val_loss: 0.150414 val_acc: 0.000000
[1/10][0/469] train_loss: 0.001551 train_acc: 0.953125
[1/10][100/469] train_loss: 0.000883 train_acc: 0.965965
[1/10][200/469] train_loss: 0.000857 train_acc: 0.966651
[1/10][300/469] train_loss: 0.000804 train_acc: 0.968257
[1/10][400/469] train_loss: 0.000777 train_acc: 0.969451
Clean dataset testing:[1/10] val_loss: 0.000689 val_acc: 0.971700
AT dataset testing:[1/10] val_loss: 0.192706 val_acc: 0.000000
[2/10][0/469] train_loss: 0.000276 train_acc: 1.000000
[2/10][100/469] train_loss: 0.000469 train_acc: 0.982209
[2/10][200/469] train_loss: 0.000458 train_acc: 0.981654
[2/10][300/469] train_loss: 0.000476 train_acc: 0.980923
[2/10][400/469] train_loss: 0.000487 train_acc: 0.980478
Clean dataset testing:[2/10] val_loss: 0.000694 val_acc: 0.971400
AT dataset testing:[2/10] val_loss: 0.225347 val_acc: 0.000000
[3/10][0/469] train_loss: 0.000469 train_acc: 0.968750
[3/10][100/469] train_loss: 0.000352 train_acc: 0.986231
[3/10][200/469] train_loss: 0.000344 train_acc: 0.986163
[3/10][300/469] train_loss: 0.000341 train_acc: 0.986140
[3/10][400/469] train_loss: 0.000349 train_acc: 0.985622
Clean dataset testing:[3/10] val_loss: 0.000577 val_acc: 0.978500
AT dataset testing:[3/10] val_loss: 0.245146 val_acc: 0.000100
[4/10][0/469] train_loss: 0.000177 train_acc: 0.992188
[4/10][100/469] train_loss: 0.000231 train_acc: 0.991569
[4/10][200/469] train_loss: 0.000258 train_acc: 0.989972
[4/10][300/469] train_loss: 0.000268 train_acc: 0.989358
[4/10][400/469] train_loss: 0.000269 train_acc: 0.989304
Clean dataset testing:[4/10] val_loss: 0.000680 val_acc: 0.973700
AT dataset testing:[4/10] val_loss: 0.275036 val_acc: 0.000000
[5/10][0/469] train_loss: 0.000128 train_acc: 0.992188
[5/10][100/469] train_loss: 0.000176 train_acc: 0.992342
[5/10][200/469] train_loss: 0.000196 train_acc: 0.991216
[5/10][300/469] train_loss: 0.000206 train_acc: 0.991020
[5/10][400/469] train_loss: 0.000213 train_acc: 0.990765
Clean dataset testing:[5/10] val_loss: 0.000658 val_acc: 0.976300
AT dataset testing:[5/10] val_loss: 0.285158 val_acc: 0.000000
[6/10][0/469] train_loss: 0.000024 train_acc: 1.000000
[6/10][100/469] train_loss: 0.000173 train_acc: 0.992033
[6/10][200/469] train_loss: 0.000142 train_acc: 0.994053
[6/10][300/469] train_loss: 0.000159 train_acc: 0.993381
[6/10][400/469] train_loss: 0.000172 train_acc: 0.992830
Clean dataset testing:[6/10] val_loss: 0.000537 val_acc: 0.981300
AT dataset testing:[6/10] val_loss: 0.325749 val_acc: 0.000000
[7/10][0/469] train_loss: 0.000030 train_acc: 1.000000
[7/10][100/469] train_loss: 0.000135 train_acc: 0.994663
[7/10][200/469] train_loss: 0.000136 train_acc: 0.994597
[7/10][300/469] train_loss: 0.000147 train_acc: 0.993952
[7/10][400/469] train_loss: 0.000154 train_acc: 0.993493
Clean dataset testing:[7/10] val_loss: 0.000573 val_acc: 0.980300
AT dataset testing:[7/10] val_loss: 0.316727 val_acc: 0.000000
[8/10][0/469] train_loss: 0.000015 train_acc: 1.000000
[8/10][100/469] train_loss: 0.000118 train_acc: 0.994508
[8/10][200/469] train_loss: 0.000120 train_acc: 0.994364
[8/10][300/469] train_loss: 0.000128 train_acc: 0.994082
[8/10][400/469] train_loss: 0.000126 train_acc: 0.994350
Clean dataset testing:[8/10] val_loss: 0.000632 val_acc: 0.979200
AT dataset testing:[8/10] val_loss: 0.363825 val_acc: 0.010600
[9/10][0/469] train_loss: 0.000089 train_acc: 0.992188
[9/10][100/469] train_loss: 0.000126 train_acc: 0.994431
[9/10][200/469] train_loss: 0.000113 train_acc: 0.994986
[9/10][300/469] train_loss: 0.000101 train_acc: 0.995536
[9/10][400/469] train_loss: 0.000107 train_acc: 0.995441
Clean dataset testing:[9/10] val_loss: 0.000598 val_acc: 0.982000
AT dataset testing:[9/10] val_loss: 0.354260 val_acc: 0.009500
nbits:6
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.017942 train_acc: 0.132812
[0/10][100/469] train_loss: 0.004602 train_acc: 0.834158
[0/10][200/469] train_loss: 0.003259 train_acc: 0.881452
[0/10][300/469] train_loss: 0.002666 train_acc: 0.901993
[0/10][400/469] train_loss: 0.002291 train_acc: 0.915270
Clean dataset testing:[0/10] val_loss: 0.000955 val_acc: 0.962700
AT dataset testing:[0/10] val_loss: 0.153127 val_acc: 0.000000
[1/10][0/469] train_loss: 0.001175 train_acc: 0.960938
[1/10][100/469] train_loss: 0.000767 train_acc: 0.968673
[1/10][200/469] train_loss: 0.000771 train_acc: 0.969916
[1/10][300/469] train_loss: 0.000771 train_acc: 0.970152
[1/10][400/469] train_loss: 0.000754 train_acc: 0.971029
Clean dataset testing:[1/10] val_loss: 0.000707 val_acc: 0.971400
AT dataset testing:[1/10] val_loss: 0.194148 val_acc: 0.000000
[2/10][0/469] train_loss: 0.000588 train_acc: 0.976562
[2/10][100/469] train_loss: 0.000496 train_acc: 0.980662
[2/10][200/469] train_loss: 0.000489 train_acc: 0.980061
[2/10][300/469] train_loss: 0.000491 train_acc: 0.980430
[2/10][400/469] train_loss: 0.000498 train_acc: 0.979933
Clean dataset testing:[2/10] val_loss: 0.000705 val_acc: 0.972100
AT dataset testing:[2/10] val_loss: 0.226490 val_acc: 0.000000
[3/10][0/469] train_loss: 0.000471 train_acc: 0.976562
[3/10][100/469] train_loss: 0.000321 train_acc: 0.986850
[3/10][200/469] train_loss: 0.000323 train_acc: 0.986901
[3/10][300/469] train_loss: 0.000329 train_acc: 0.986270
[3/10][400/469] train_loss: 0.000345 train_acc: 0.985739
Clean dataset testing:[3/10] val_loss: 0.000709 val_acc: 0.974400
AT dataset testing:[3/10] val_loss: 0.253600 val_acc: 0.000000
[4/10][0/469] train_loss: 0.000550 train_acc: 0.984375
[4/10][100/469] train_loss: 0.000202 train_acc: 0.991878
[4/10][200/469] train_loss: 0.000227 train_acc: 0.990866
[4/10][300/469] train_loss: 0.000222 train_acc: 0.990890
[4/10][400/469] train_loss: 0.000239 train_acc: 0.990220
Clean dataset testing:[4/10] val_loss: 0.000549 val_acc: 0.978800
AT dataset testing:[4/10] val_loss: 0.273708 val_acc: 0.000000
[5/10][0/469] train_loss: 0.000359 train_acc: 0.976562
[5/10][100/469] train_loss: 0.000162 train_acc: 0.992806
[5/10][200/469] train_loss: 0.000161 train_acc: 0.992926
[5/10][300/469] train_loss: 0.000178 train_acc: 0.992577
[5/10][400/469] train_loss: 0.000190 train_acc: 0.991954
Clean dataset testing:[5/10] val_loss: 0.000599 val_acc: 0.978200
AT dataset testing:[5/10] val_loss: 0.307242 val_acc: 0.000000
[6/10][0/469] train_loss: 0.000187 train_acc: 0.992188
[6/10][100/469] train_loss: 0.000185 train_acc: 0.991569
[6/10][200/469] train_loss: 0.000168 train_acc: 0.992576
[6/10][300/469] train_loss: 0.000165 train_acc: 0.992810
[6/10][400/469] train_loss: 0.000169 train_acc: 0.992675
Clean dataset testing:[6/10] val_loss: 0.000599 val_acc: 0.979600
AT dataset testing:[6/10] val_loss: 0.334900 val_acc: 0.000100
[7/10][0/469] train_loss: 0.000137 train_acc: 0.992188
[7/10][100/469] train_loss: 0.000164 train_acc: 0.992342
[7/10][200/469] train_loss: 0.000134 train_acc: 0.993664
[7/10][300/469] train_loss: 0.000136 train_acc: 0.993823
[7/10][400/469] train_loss: 0.000136 train_acc: 0.993668
Clean dataset testing:[7/10] val_loss: 0.000622 val_acc: 0.979900
AT dataset testing:[7/10] val_loss: 0.361463 val_acc: 0.000000
[8/10][0/469] train_loss: 0.000071 train_acc: 0.992188
[8/10][100/469] train_loss: 0.000149 train_acc: 0.993116
[8/10][200/469] train_loss: 0.000150 train_acc: 0.993081
[8/10][300/469] train_loss: 0.000138 train_acc: 0.993797
[8/10][400/469] train_loss: 0.000128 train_acc: 0.994350
Clean dataset testing:[8/10] val_loss: 0.000617 val_acc: 0.980700
AT dataset testing:[8/10] val_loss: 0.369942 val_acc: 0.000100
[9/10][0/469] train_loss: 0.000056 train_acc: 1.000000
[9/10][100/469] train_loss: 0.000136 train_acc: 0.993348
[9/10][200/469] train_loss: 0.000142 train_acc: 0.993470
[9/10][300/469] train_loss: 0.000125 train_acc: 0.994420
[9/10][400/469] train_loss: 0.000121 train_acc: 0.994623
Clean dataset testing:[9/10] val_loss: 0.000961 val_acc: 0.971300
AT dataset testing:[9/10] val_loss: 0.353058 val_acc: 0.000600
nbits:7
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.018038 train_acc: 0.117188
[0/10][100/469] train_loss: 0.004525 train_acc: 0.840888
[0/10][200/469] train_loss: 0.003226 train_acc: 0.885145
[0/10][300/469] train_loss: 0.002650 train_acc: 0.904797
[0/10][400/469] train_loss: 0.002291 train_acc: 0.917121
Clean dataset testing:[0/10] val_loss: 0.000888 val_acc: 0.965400
AT dataset testing:[0/10] val_loss: 0.154068 val_acc: 0.000000
[1/10][0/469] train_loss: 0.000412 train_acc: 0.992188
[1/10][100/469] train_loss: 0.000793 train_acc: 0.968595
[1/10][200/469] train_loss: 0.000772 train_acc: 0.969838
[1/10][300/469] train_loss: 0.000754 train_acc: 0.970359
[1/10][400/469] train_loss: 0.000744 train_acc: 0.970971
Clean dataset testing:[1/10] val_loss: 0.000688 val_acc: 0.973300
AT dataset testing:[1/10] val_loss: 0.180583 val_acc: 0.000000
[2/10][0/469] train_loss: 0.000212 train_acc: 1.000000
[2/10][100/469] train_loss: 0.000467 train_acc: 0.981590
[2/10][200/469] train_loss: 0.000487 train_acc: 0.980955
[2/10][300/469] train_loss: 0.000477 train_acc: 0.981364
[2/10][400/469] train_loss: 0.000476 train_acc: 0.981336
Clean dataset testing:[2/10] val_loss: 0.000579 val_acc: 0.977600
AT dataset testing:[2/10] val_loss: 0.206570 val_acc: 0.000000
[3/10][0/469] train_loss: 0.000187 train_acc: 1.000000
[3/10][100/469] train_loss: 0.000329 train_acc: 0.986154
[3/10][200/469] train_loss: 0.000323 train_acc: 0.986785
[3/10][300/469] train_loss: 0.000323 train_acc: 0.986270
[3/10][400/469] train_loss: 0.000333 train_acc: 0.985856
Clean dataset testing:[3/10] val_loss: 0.000597 val_acc: 0.976600
AT dataset testing:[3/10] val_loss: 0.228678 val_acc: 0.000000
[4/10][0/469] train_loss: 0.000094 train_acc: 1.000000
[4/10][100/469] train_loss: 0.000225 train_acc: 0.990795
[4/10][200/469] train_loss: 0.000227 train_acc: 0.990516
[4/10][300/469] train_loss: 0.000247 train_acc: 0.989903
[4/10][400/469] train_loss: 0.000250 train_acc: 0.989830
Clean dataset testing:[4/10] val_loss: 0.000602 val_acc: 0.978700
AT dataset testing:[4/10] val_loss: 0.255292 val_acc: 0.000000
[5/10][0/469] train_loss: 0.000239 train_acc: 0.984375
[5/10][100/469] train_loss: 0.000154 train_acc: 0.994044
[5/10][200/469] train_loss: 0.000176 train_acc: 0.992926
[5/10][300/469] train_loss: 0.000181 train_acc: 0.992603
[5/10][400/469] train_loss: 0.000189 train_acc: 0.992071
Clean dataset testing:[5/10] val_loss: 0.000529 val_acc: 0.981700
AT dataset testing:[5/10] val_loss: 0.299481 val_acc: 0.000000
[6/10][0/469] train_loss: 0.000090 train_acc: 1.000000
[6/10][100/469] train_loss: 0.000119 train_acc: 0.995591
[6/10][200/469] train_loss: 0.000140 train_acc: 0.994286
[6/10][300/469] train_loss: 0.000154 train_acc: 0.993641
[6/10][400/469] train_loss: 0.000150 train_acc: 0.993824
Clean dataset testing:[6/10] val_loss: 0.000554 val_acc: 0.980800
AT dataset testing:[6/10] val_loss: 0.326404 val_acc: 0.000000
[7/10][0/469] train_loss: 0.000078 train_acc: 0.992188
[7/10][100/469] train_loss: 0.000136 train_acc: 0.994431
[7/10][200/469] train_loss: 0.000111 train_acc: 0.995452
[7/10][300/469] train_loss: 0.000116 train_acc: 0.995250
[7/10][400/469] train_loss: 0.000126 train_acc: 0.994720
Clean dataset testing:[7/10] val_loss: 0.000676 val_acc: 0.977500
AT dataset testing:[7/10] val_loss: 0.342749 val_acc: 0.000000
[8/10][0/469] train_loss: 0.000049 train_acc: 1.000000
[8/10][100/469] train_loss: 0.000111 train_acc: 0.995668
[8/10][200/469] train_loss: 0.000107 train_acc: 0.995725
[8/10][300/469] train_loss: 0.000122 train_acc: 0.994991
[8/10][400/469] train_loss: 0.000117 train_acc: 0.995188
Clean dataset testing:[8/10] val_loss: 0.000662 val_acc: 0.980000
AT dataset testing:[8/10] val_loss: 0.346100 val_acc: 0.000000
[9/10][0/469] train_loss: 0.000151 train_acc: 0.992188
[9/10][100/469] train_loss: 0.000098 train_acc: 0.995978
[9/10][200/469] train_loss: 0.000095 train_acc: 0.996035
[9/10][300/469] train_loss: 0.000088 train_acc: 0.996444
[9/10][400/469] train_loss: 0.000090 train_acc: 0.996376
Clean dataset testing:[9/10] val_loss: 0.000663 val_acc: 0.978400
AT dataset testing:[9/10] val_loss: 0.362411 val_acc: 0.000000
nbits:8
all_fc_quan(
  (features): Sequential(
    (0): Linear(in_features=784, out_features=500, bias=True)
    (1): ReLU(inplace)
    (2): Linear(in_features=500, out_features=500, bias=True)
    (3): ReLU(inplace)
    (4): Linear(in_features=500, out_features=10, bias=True)
  )
)
[0/10][0/469] train_loss: 0.018001 train_acc: 0.101562
[0/10][100/469] train_loss: 0.004534 train_acc: 0.837098
[0/10][200/469] train_loss: 0.003277 train_acc: 0.881258
[0/10][300/469] train_loss: 0.002668 train_acc: 0.901941
[0/10][400/469] train_loss: 0.002302 train_acc: 0.915270
Clean dataset testing:[0/10] val_loss: 0.001002 val_acc: 0.960800
AT dataset testing:[0/10] val_loss: 0.146097 val_acc: 0.000000
[1/10][0/469] train_loss: 0.000764 train_acc: 0.976562
[1/10][100/469] train_loss: 0.000800 train_acc: 0.967667
[1/10][200/469] train_loss: 0.000779 train_acc: 0.967895
[1/10][300/469] train_loss: 0.000760 train_acc: 0.969321
[1/10][400/469] train_loss: 0.000740 train_acc: 0.970387
Clean dataset testing:[1/10] val_loss: 0.000652 val_acc: 0.972800
AT dataset testing:[1/10] val_loss: 0.190560 val_acc: 0.000000
[2/10][0/469] train_loss: 0.000833 train_acc: 0.953125
[2/10][100/469] train_loss: 0.000488 train_acc: 0.981358
[2/10][200/469] train_loss: 0.000490 train_acc: 0.981266
[2/10][300/469] train_loss: 0.000477 train_acc: 0.981286
[2/10][400/469] train_loss: 0.000470 train_acc: 0.981492
Clean dataset testing:[2/10] val_loss: 0.000630 val_acc: 0.975400
AT dataset testing:[2/10] val_loss: 0.215434 val_acc: 0.000000
[3/10][0/469] train_loss: 0.000808 train_acc: 0.960938
[3/10][100/469] train_loss: 0.000312 train_acc: 0.986773
[3/10][200/469] train_loss: 0.000325 train_acc: 0.986979
[3/10][300/469] train_loss: 0.000322 train_acc: 0.987126
[3/10][400/469] train_loss: 0.000330 train_acc: 0.986596
Clean dataset testing:[3/10] val_loss: 0.000536 val_acc: 0.979400
AT dataset testing:[3/10] val_loss: 0.247985 val_acc: 0.000000
[4/10][0/469] train_loss: 0.000224 train_acc: 1.000000
[4/10][100/469] train_loss: 0.000203 train_acc: 0.992265
[4/10][200/469] train_loss: 0.000215 train_acc: 0.991566
[4/10][300/469] train_loss: 0.000228 train_acc: 0.990864
[4/10][400/469] train_loss: 0.000241 train_acc: 0.990337
Clean dataset testing:[4/10] val_loss: 0.000514 val_acc: 0.979800
AT dataset testing:[4/10] val_loss: 0.271030 val_acc: 0.000000
[5/10][0/469] train_loss: 0.000293 train_acc: 0.976562
[5/10][100/469] train_loss: 0.000171 train_acc: 0.993116
[5/10][200/469] train_loss: 0.000153 train_acc: 0.993315
[5/10][300/469] train_loss: 0.000175 train_acc: 0.992629
[5/10][400/469] train_loss: 0.000185 train_acc: 0.992324
Clean dataset testing:[5/10] val_loss: 0.000563 val_acc: 0.979900
AT dataset testing:[5/10] val_loss: 0.289978 val_acc: 0.000000
[6/10][0/469] train_loss: 0.000080 train_acc: 1.000000
[6/10][100/469] train_loss: 0.000142 train_acc: 0.993425
[6/10][200/469] train_loss: 0.000147 train_acc: 0.993392
[6/10][300/469] train_loss: 0.000161 train_acc: 0.993096
[6/10][400/469] train_loss: 0.000167 train_acc: 0.992791
Clean dataset testing:[6/10] val_loss: 0.000549 val_acc: 0.981400
AT dataset testing:[6/10] val_loss: 0.326613 val_acc: 0.000100
[7/10][0/469] train_loss: 0.000151 train_acc: 0.984375
[7/10][100/469] train_loss: 0.000125 train_acc: 0.994663
[7/10][200/469] train_loss: 0.000128 train_acc: 0.994364
[7/10][300/469] train_loss: 0.000132 train_acc: 0.994186
[7/10][400/469] train_loss: 0.000139 train_acc: 0.993882
Clean dataset testing:[7/10] val_loss: 0.000666 val_acc: 0.979700
AT dataset testing:[7/10] val_loss: 0.340024 val_acc: 0.000300
[8/10][0/469] train_loss: 0.000054 train_acc: 1.000000
[8/10][100/469] train_loss: 0.000104 train_acc: 0.995668
[8/10][200/469] train_loss: 0.000102 train_acc: 0.995802
[8/10][300/469] train_loss: 0.000113 train_acc: 0.995250
[8/10][400/469] train_loss: 0.000113 train_acc: 0.995188
Clean dataset testing:[8/10] val_loss: 0.000677 val_acc: 0.977300
AT dataset testing:[8/10] val_loss: 0.362892 val_acc: 0.000000
[9/10][0/469] train_loss: 0.000065 train_acc: 0.992188
[9/10][100/469] train_loss: 0.000106 train_acc: 0.995204
[9/10][200/469] train_loss: 0.000117 train_acc: 0.994831
[9/10][300/469] train_loss: 0.000123 train_acc: 0.994523
[9/10][400/469] train_loss: 0.000120 train_acc: 0.994720
Clean dataset testing:[9/10] val_loss: 0.000716 val_acc: 0.979000
AT dataset testing:[9/10] val_loss: 0.374799 val_acc: 0.000000
